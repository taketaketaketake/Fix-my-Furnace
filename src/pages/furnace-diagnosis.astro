---
/**
 * Landing Page 4: Photo Diagnosis Callback Request
 * Upload photos and get expert callback within 24 hours
 */
import Layout from "../layouts/Layout.astro";
import FurnaceDiagnosisScript from "../components/FurnaceDiagnosisScript.astro";
---

<Layout title="Upload Photos & Get Expert Callback | Fix My Furnace - Michigan" hideHeader={true} hideTopBanner={true}>

  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-white py-16 px-6">
    <div class="container mx-auto max-w-5xl text-center">

      <h1 class="text-5xl md:text-6xl font-black mb-6 leading-tight">
        Get Expert Furnace<br/>
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-cyan-400 to-green-400">
          Analysis FREE.
        </span>
      </h1>

      <p class="text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto">
        Upload 3 photos and our licensed techs will analyze your furnace problem at no cost. Get a preliminary diagnosis before scheduling a home visit.
      </p>

      <div class="flex flex-wrap justify-center gap-6 text-lg">
        <div class="flex items-center gap-3">
          <svg class="w-8 h-8 text-green-400" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <span>100% Free Analysis</span>
        </div>
        <div class="flex items-center gap-3">
          <svg class="w-8 h-8 text-green-400" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
          <span>No Commitment Required</span>
        </div>
      </div>

    </div>
  </section>

  <!-- Form Section -->
  <section class="py-16 px-6 bg-white">
    <div class="container mx-auto max-w-3xl">

      <div class="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-3xl p-8 md:p-12 border-2 border-blue-200">

        <h2 class="text-3xl md:text-4xl font-black text-gray-900 mb-4 text-center">
          Upload Your Photos
        </h2>
        <p class="text-gray-600 text-center mb-8 text-lg">
          Our licensed techs will review them and call you back within 24 hours.
        </p>

        <!-- Success/Error Messages -->
        <div id="form-messages" class="mb-6 hidden">
          <div id="success-message" class="bg-green-50 border-2 border-green-200 rounded-xl p-6 mb-4 hidden">
            <div class="flex items-start gap-4">
              <svg class="w-8 h-8 text-green-600 flex-shrink-0 mt-1" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
              </svg>
              <div>
                <h4 class="text-green-900 font-bold text-lg mb-1">Photos Uploaded Successfully!</h4>
                <p class="text-green-800">We'll review your photos and call you back within 24 hours. Check your email for confirmation.</p>
              </div>
            </div>
          </div>

          <div id="error-message" class="bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-4 hidden">
            <div class="flex items-start gap-4">
              <svg class="w-8 h-8 text-red-600 flex-shrink-0 mt-1" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
              </svg>
              <div>
                <h4 class="text-red-900 font-bold text-lg mb-1">Submission Failed</h4>
                <p id="error-text" class="text-red-800">Something went wrong. Please try again.</p>
              </div>
            </div>
          </div>

          <div id="loading-message" class="bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mb-4 hidden">
            <div class="flex items-center gap-4">
              <svg class="animate-spin w-8 h-8 text-blue-600" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <div>
                <h4 class="text-blue-900 font-bold text-lg mb-1">Uploading Photos...</h4>
                <p id="upload-progress" class="text-blue-800">Please wait while we process your submission.</p>
              </div>
            </div>
          </div>
        </div>

        <form id="photo-callback-form" class="space-y-6">

          <!-- Step 1: Problem Description & Photo Upload -->
          <div id="step1" class="space-y-6">
            <!-- Last Service -->
            <div>
              <label for="last_service" class="block text-sm font-bold text-gray-800 mb-2">
                When was the last time your furnace was serviced? <span class="text-red-500">*</span>
              </label>
              <select
                id="last_service"
                name="last_service"
                required
                class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-gray-800 focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition"
              >
                <option value="">Select timeframe</option>
                <option value="0-6_months">Within the last 6 months</option>
                <option value="6-12_months">6-12 months ago</option>
                <option value="1-2_years">1-2 years ago</option>
                <option value="3-5_years">3-5 years ago</option>
                <option value="5_years_plus">More than 5 years ago</option>
                <option value="never">Never serviced</option>
                <option value="unsure">I'm not sure</option>
              </select>
            </div>

            <!-- Photo Upload -->
            <div>
              <label for="photos" class="block text-sm font-bold text-gray-800 mb-2">
                Upload Photos <span class="text-red-500">*</span>
              </label>
              <p class="text-sm text-gray-600 mb-3">
                Upload photos of your furnace, error codes, damaged parts, or problem areas. Maximum 5 photos, 10MB each.
              </p>

              <div class="relative">
                <input
                  type="file"
                  id="photos"
                  name="photos"
                  accept="image/jpeg,image/png,image/jpg,image/heic,image/webp"
                  multiple
                  required
                  class="hidden"
                />
                <label
                  for="photos"
                  class="flex flex-col items-center justify-center w-full border-2 border-dashed border-gray-300 rounded-xl px-6 py-12 cursor-pointer hover:border-blue-500 hover:bg-blue-50/50 transition-all"
                >
                  <svg class="w-16 h-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                  </svg>
                  <p class="text-gray-700 font-semibold mb-1">Click to upload photos</p>
                  <p class="text-gray-500 text-sm">or drag and drop</p>
                  <p class="text-gray-400 text-xs mt-2">JPEG, PNG, HEIC up to 10MB each</p>
                </label>
              </div>

              <!-- Photo Preview -->
              <div id="photo-preview" class="mt-4 grid grid-cols-2 sm:grid-cols-3 gap-4 hidden">
                <!-- Preview thumbnails will be inserted here -->
              </div>
            </div>

            <!-- Continue Button -->
            <button
              type="button"
              id="next-step-btn"
              class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-black text-xl py-5 rounded-xl shadow-xl hover:from-blue-700 hover:to-cyan-700 active:scale-[0.98] transition-all"
            >
              Continue
            </button>
          </div>

          <!-- Step 2: Contact Information -->
          <div id="step2" class="hidden space-y-6">
            <!-- Step 2 Header -->
            <div class="text-center mb-6">
              <h3 class="text-2xl font-bold text-gray-900 mb-2">Almost Done!</h3>
              <p class="text-sm text-gray-600">Our expert technicians will review your photos and call you back within 24 hours.</p>
            </div>

            <!-- Name -->
            <div>
              <label for="name" class="block text-sm font-bold text-gray-800 mb-2">
                Full Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="Enter your full name"
                class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-gray-800 focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition"
              />
            </div>

            <!-- Phone -->
            <div>
              <label for="phone" class="block text-sm font-bold text-gray-800 mb-2">
                Phone Number <span class="text-red-500">*</span>
              </label>
              <input
                type="tel"
                id="phone"
                name="phone"
                required
                maxlength="14"
                placeholder="(313) 555-1234"
                class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-gray-800 focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition"
              />
              <p id="phone-error" class="text-red-600 text-sm mt-1 hidden">Please enter a valid phone number</p>
            </div>

            <!-- Service Address -->
            <div>
              <label for="address" class="block text-sm font-bold text-gray-800 mb-2">
                Service Address <span class="text-red-500">*</span>
              </label>
              <div class="relative">
                <input
                  type="text"
                  id="address"
                  name="address"
                  required
                  placeholder="Enter your full address"
                  autocomplete="off"
                  class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-gray-800 focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition"
                />
                <!-- Address suggestions dropdown -->
                <div id="address-suggestions" class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 hidden max-h-48 overflow-y-auto">
                </div>
              </div>
            </div>

            <!-- Preferred Callback Time -->
            <div>
              <label for="preferredTime" class="block text-sm font-bold text-gray-800 mb-2">
                Preferred Callback Time
              </label>
              <select
                id="preferredTime"
                name="preferredTime"
                class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-gray-800 focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition"
              >
                <option value="">Any time works</option>
                <option value="morning">Morning (8am - 12pm)</option>
                <option value="afternoon">Afternoon (12pm - 5pm)</option>
                <option value="evening">Evening (5pm - 8pm)</option>
              </select>
            </div>

            <!-- Submit Button -->
            <button
              type="submit"
              id="submit-btn"
              class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-black text-xl py-5 rounded-xl shadow-xl hover:from-blue-700 hover:to-cyan-700 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <span id="submit-text">Upload Photos & Request Callback</span>
              <span id="submit-loading" class="hidden">
                <svg class="animate-spin inline w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Uploading...
              </span>
            </button>

            <p class="text-sm text-gray-500 text-center">
              By submitting, you agree to receive a callback from Fix My Furnace within 24 hours.
            </p>
          </div>

        </form>

      </div>

    </div>
  </section>

  <!-- What to Photograph Section -->
  <section class="py-16 px-6 bg-gradient-to-br from-gray-50 via-blue-50 to-gray-50">
    <div class="container mx-auto max-w-5xl">

      <h2 class="text-3xl md:text-4xl font-black text-center text-gray-900 mb-12">
        What Should You Photograph?
      </h2>

      <div class="grid md:grid-cols-3 gap-8">

        <div class="bg-white rounded-2xl p-6 shadow-lg">
          <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-3">
            <span class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-black">1</span>
            Overall Furnace View
          </h3>
          <div class="relative mb-4 rounded-xl overflow-hidden">
            <img 
              src="/furnace-straight.png" 
              alt="Example of how to photograph your entire furnace from the front showing overall condition and setup"
              class="w-full h-auto object-contain"
            />
            <div class="absolute top-3 right-3">
              <span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">âœ“ Good Example</span>
            </div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3 mb-4 border border-gray-200">
            <div class="flex items-center gap-1 mb-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Clear, well-lit front view</span>
            </div>
            <div class="flex items-center gap-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Shows entire unit and connections</span>
            </div>
          </div>
          <p class="text-gray-600 mb-4">
            Take a wide shot showing your entire furnace from the front, including how it's positioned and connected to ductwork.
          </p>
          <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
            <p class="text-sm text-blue-900">
              <strong>ðŸ’¡ Tip:</strong> Stand back 3-4 feet to capture the whole unit and surrounding area!
            </p>
          </div>
        </div>

        <div class="bg-white rounded-2xl p-6 shadow-lg">
          <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-3">
            <span class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-black">2</span>
            Close-up Details
          </h3>
          <div class="relative mb-4 rounded-xl overflow-hidden">
            <img 
              src="/furnace-closeup.png" 
              alt="Example of close-up furnace photo showing model label, control panel, and important details for diagnosis"
              class="w-full h-auto object-contain"
            />
            <div class="absolute top-3 right-3">
              <span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">âœ“ Good Example</span>
            </div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3 mb-4 border border-gray-200">
            <div class="flex items-center gap-1 mb-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Model label clearly visible</span>
            </div>
            <div class="flex items-center gap-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Control panel in focus</span>
            </div>
          </div>
          <p class="text-gray-600 mb-4">
            Capture close-ups of the model label, control panel, any error codes, and specific problem areas you can see.
          </p>
          <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
            <p class="text-sm text-blue-900">
              <strong>ðŸ’¡ Tip:</strong> Error codes and model numbers are the most helpful for diagnosis!
            </p>
          </div>
        </div>

        <div class="bg-white rounded-2xl p-6 shadow-lg">
          <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-3">
            <span class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-black">3</span>
            Side Angle View
          </h3>
          <div class="relative mb-4 rounded-xl overflow-hidden">
            <img 
              src="/furnace-side-angle.png" 
              alt="Example of furnace photographed from side angle showing connections, venting, and access panels"
              class="w-full h-auto object-contain"
            />
            <div class="absolute top-3 right-3">
              <span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">âœ“ Good Example</span>
            </div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3 mb-4 border border-gray-200">
            <div class="flex items-center gap-1 mb-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Shows venting and connections</span>
            </div>
            <div class="flex items-center gap-1 text-sm">
              <span class="text-green-500">âœ“</span>
              <span class="text-gray-700">Good lighting with flash</span>
            </div>
          </div>
          <p class="text-gray-600 mb-4">
            Take a side view to show venting, gas lines, electrical connections, and any visible damage or leaks.
          </p>
          <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
            <p class="text-sm text-blue-900">
              <strong>ðŸ’¡ Tip:</strong> Use your phone's flash for dark basement areas and tight spaces!
            </p>
          </div>
        </div>

      </div>

    </div>
  </section>

  <!-- Trust / How It Works -->
  <section class="py-16 px-6 bg-white">
    <div class="container mx-auto max-w-5xl">

      <h2 class="text-3xl md:text-4xl font-black text-center text-gray-900 mb-12">
        What Happens After You Upload?
      </h2>

      <div class="grid md:grid-cols-3 gap-8">

        <div class="text-center">
          <div class="w-20 h-20 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center text-white text-3xl font-black mb-6 mx-auto shadow-xl">
            1
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-3">We Review Your Photos</h3>
          <p class="text-gray-600">
            Our licensed HVAC techs look at your photos and problem description to get a preliminary understanding of the issue.
          </p>
        </div>

        <div class="text-center">
          <div class="w-20 h-20 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center text-white text-3xl font-black mb-6 mx-auto shadow-xl">
            2
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-3">We Call You Back</h3>
          <p class="text-gray-600">
            Within 24 hours, we'll call to discuss what we found, answer questions, and give you a preliminary assessment.
          </p>
        </div>

        <div class="text-center">
          <div class="w-20 h-20 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center text-white text-3xl font-black mb-6 mx-auto shadow-xl">
            3
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-3">You Decide Next Steps</h3>
          <p class="text-gray-600">
            We'll explain your options and pricing. If you want to move forward, we'll schedule your $125 home visit.
          </p>
        </div>

      </div>

    </div>
  </section>

  <!-- Progressive Sticky Mobile CTA -->
  <div id="progressive-cta" class="md:hidden fixed bottom-0 left-0 right-0 bg-gradient-to-r from-blue-600 to-cyan-600 p-4 shadow-2xl z-50 border-t-4 border-green-400 transition-all duration-300">
    <a href="#photo-callback-form" id="cta-button" class="block bg-white text-blue-600 text-center py-4 rounded-xl font-black text-lg shadow-xl transition-all duration-200 hover:scale-105">
      <span id="cta-main-text">Get Free Analysis</span>
      <div id="social-proof" class="text-xs text-gray-600 mt-1 font-normal">
        <span id="social-proof-text">Join 1,200+ homeowners who saved money</span>
      </div>
    </a>
  </div>

  <!-- Exit Intent Mobile CTA -->
  <div id="exit-intent-cta" class="md:hidden fixed bottom-0 left-0 right-0 bg-gradient-to-r from-red-600 to-orange-600 p-4 shadow-2xl z-60 border-t-4 border-yellow-400 transform translate-y-full transition-transform duration-300">
    <div class="bg-white rounded-xl p-4 text-center shadow-xl">
      <div class="text-red-600 font-black text-lg mb-2">
        <span id="exit-intent-text">Wait! Don't pay $125+ elsewhere</span>
      </div>
      <a href="#photo-callback-form" class="block bg-red-600 text-white py-3 rounded-lg font-bold text-base">
        Get FREE Diagnosis Now
      </a>
    </div>
  </div>

</Layout>


<!-- Include the JavaScript functionality -->
<FurnaceDiagnosisScript />

<!-- Supabase CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
